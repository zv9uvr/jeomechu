<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>가천대역 근처 음식점 추천</title>
    <style>
        /* 공통 스타일 */
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: Arial, sans-serif;
            background-color: #f9f9f9;
            margin: 0;
            height: 100vh;
            position: relative;
        }
        .container {
            text-align: center;
        }
        h1 { font-size: 2em; color: #333; margin-bottom: 20px; }
        .button { padding: 10px 20px; font-size: 1.2em; border: none; border-radius: 5px; cursor: pointer; color: white; }
        .korean { background-color: #FF7F50; }
        .chinese { background-color: #FF6347; }
        .western { background-color: #4682B4; }
        .japanese { background-color: #6A5ACD; }
        .button:hover { opacity: 0.9; }
        #mapContainer { width: 100%; height: 500px; display: none; }
        #storeInfo { margin-top: 10px; }
    </style>
</head>
<body>
    <div class="container" id="mainPage">
        <h1>가천대역 근처 저녁 메뉴 추천</h1>
        <div>
            <button class="button korean" onclick="searchPlaces('한식')">한식</button>
            <button class="button chinese" onclick="searchPlaces('중식')">중식</button>
            <button class="button western" onclick="searchPlaces('양식')">양식</button>
            <button class="button japanese" onclick="searchPlaces('일식')">일식</button>
        </div>
    </div>
    
    <div class="container" id="categoryPage" style="display:none;">
        <h1 id="categoryTitle"></h1>
        <div id="restaurantList"></div>
        <button onclick="goBack()">뒤로가기</button>
    </div>

    <div id="mapContainer"></div>
    <div id="storeInfo"></div>

    <!-- Kakao Maps API 스크립트 (자신의 JavaScript 키로 대체) -->
    <script type="text/javascript" src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=bf82efef9d1689d7ae8db1f8a0b75887&libraries=services"></script>
    <script>
        let map, places, markers = [];

        function searchPlaces(category) {
            document.getElementById("mainPage").style.display = "none";
            document.getElementById("categoryPage").style.display = "block";
            document.getElementById("categoryTitle").textContent = `가천대역 근처 ${category} 맛집`;

            if (!map) {
                map = new kakao.maps.Map(document.getElementById("mapContainer"), {
                    center: new kakao.maps.LatLng(37.448365, 127.127707), // 가천대역 중심으로 설정
                    level: 3
                });
            }
            
            places = new kakao.maps.services.Places();
            places.keywordSearch(`가천대역 ${category}`, displayPlaces);
        }

        function displayPlaces(data, status) {
            if (status === kakao.maps.services.Status.OK) {
                const restaurantList = document.getElementById("restaurantList");
                restaurantList.innerHTML = ''; // 기존 리스트 초기화
                removeMarkers(); // 기존 마커 삭제

                data.forEach(place => {
                    const listItem = document.createElement("button");
                    listItem.textContent = place.place_name; // 가게 이름
                    listItem.classList.add("button");
                    listItem.onclick = () => showMap(place); // 클릭 시 showMap 호출
                    restaurantList.appendChild(listItem);

                    const marker = new kakao.maps.Marker({
                        position: new kakao.maps.LatLng(place.y, place.x)
                    });
                    marker.setMap(map);
                    markers.push(marker);
                });

                document.getElementById("mapContainer").style.display = "block";
                map.setCenter(new kakao.maps.LatLng(data[0].y, data[0].x));
            } else {
                alert('검색 결과가 없습니다.');
                goBack(); // 검색 결과가 없을 때 메인 페이지로 돌아가기
            }
        }

        function showMap(place) {
            map.setCenter(new kakao.maps.LatLng(place.y, place.x));
            document.getElementById("storeInfo").innerHTML = `<h2>${place.place_name}</h2><p>${place.address_name}</p><p>${place.phone || '전화번호 없음'}</p>`;
        }

        function goBack() {
            document.getElementById("mainPage").style.display = "block";
            document.getElementById("categoryPage").style.display = "none";
            document.getElementById("mapContainer").style.display = "none";
            document.getElementById("storeInfo").innerHTML = '';
            removeMarkers();
        }

        function removeMarkers() {
            markers.forEach(marker => marker.setMap(null));
            markers = [];
        }
    </script>
</body>
</html>
